<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üîç –©–æ –∑–Ω–∏–∫–ª–æ?</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Comic+Neue:wght@400;700&display=swap');
  *{box-sizing:border-box;margin:0;padding:0}
  body{font-family:'Comic Neue','Comic Sans MS',cursive;background:linear-gradient(135deg,#e3f2fd,#f3e5f5,#e8f5e9);min-height:100vh;padding:10px;user-select:none}
  .container{max-width:520px;margin:0 auto;text-align:center}
  h1{font-size:28px;color:#2c3e80;margin:10px 0}
  .subtitle{font-size:16px;color:#666;margin-bottom:12px}

  .menu{margin-top:20px}
  .menu-btn{display:block;width:100%;padding:16px;margin:10px 0;border:none;border-radius:16px;font-size:20px;font-weight:700;font-family:inherit;cursor:pointer;color:white;box-shadow:0 3px 12px rgba(0,0,0,0.15);transition:transform 0.15s}
  .menu-btn:active{transform:scale(0.97)}
  .btn-easy{background:linear-gradient(135deg,#4CAF50,#2e7d32)}
  .btn-medium{background:linear-gradient(135deg,#FF9800,#e65100)}
  .btn-hard{background:linear-gradient(135deg,#e53935,#b71c1c)}

  .game{display:none}
  .back-btn{background:none;border:2px solid #ddd;border-radius:20px;padding:6px 16px;font-size:14px;font-family:inherit;color:#888;cursor:pointer;margin-bottom:10px}
  .back-btn:active{background:#f0f0f0}

  .phase-text{font-size:22px;font-weight:700;color:#2c3e80;margin:10px 0;min-height:30px}
  .round-info{font-size:14px;color:#999;margin-bottom:8px}

  .grid{display:flex;flex-wrap:wrap;justify-content:center;gap:12px;margin:15px 0;min-height:200px}
  .item{font-size:48px;width:70px;height:70px;display:flex;align-items:center;justify-content:center;background:white;border-radius:16px;box-shadow:0 2px 8px rgba(0,0,0,0.1);transition:all 0.3s;cursor:default}
  .item.hidden{opacity:0;transform:scale(0)}
  .item.clickable{cursor:pointer;border:3px solid transparent}
  .item.clickable:hover{border-color:#FFD700;transform:scale(1.1)}
  .item.clickable:active{transform:scale(0.9)}
  .item.correct{background:#e8f5e9;border:3px solid #4CAF50;animation:bounce 0.5s}
  .item.wrong{background:#ffebee;border:3px solid #f44336;animation:shake 0.5s}

  @keyframes bounce{0%{transform:scale(1)}50%{transform:scale(1.2)}100%{transform:scale(1)}}
  @keyframes shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-8px)}75%{transform:translateX(8px)}}

  .answers{display:flex;flex-wrap:wrap;justify-content:center;gap:10px;margin:15px 0}
  .answer-btn{font-size:42px;width:65px;height:65px;display:flex;align-items:center;justify-content:center;background:white;border-radius:16px;border:3px solid #ddd;cursor:pointer;transition:all 0.15s;box-shadow:0 2px 6px rgba(0,0,0,0.08)}
  .answer-btn:hover{border-color:#FFD700;transform:scale(1.1)}
  .answer-btn:active{transform:scale(0.9)}

  .timer-bar{width:100%;height:8px;background:#eee;border-radius:4px;margin:8px 0;overflow:hidden}
  .timer-fill{height:100%;background:linear-gradient(90deg,#4CAF50,#FFD700);border-radius:4px;transition:width 0.1s linear}

  .score-section{background:white;border-radius:20px;padding:20px;margin-top:15px;box-shadow:0 4px 15px rgba(0,0,0,0.1)}
  .score-big{font-size:48px;font-weight:700;color:#2c3e80}
  .score-emoji{font-size:52px;margin:8px 0}
  .score-msg{font-size:20px;font-weight:700;color:#555;margin:8px 0}
  .retry-btn{background:linear-gradient(135deg,#4CAF50,#2e7d32);color:white;border:none;border-radius:30px;padding:12px 32px;font-size:18px;font-weight:700;font-family:inherit;cursor:pointer;margin-top:10px}
  .retry-btn:active{transform:scale(0.95)}
  .hint-btn{background:linear-gradient(135deg,#FFD700,#FFA000);color:#333;border:none;border-radius:30px;padding:10px 24px;font-size:16px;font-weight:700;font-family:inherit;cursor:pointer;margin:10px 0;box-shadow:0 2px 8px rgba(0,0,0,0.15);transition:transform 0.15s,opacity 0.2s}
  .hint-btn:active{transform:scale(0.95)}
  .hint-btn:disabled{opacity:0.4;cursor:not-allowed}

  .confetti-piece{position:fixed;border-radius:2px;animation:confettiFall 3s ease-out forwards;pointer-events:none;z-index:1000}
  @keyframes confettiFall{0%{transform:translateY(-10px) rotate(0deg);opacity:1}100%{transform:translateY(100vh) rotate(720deg);opacity:0}}

  .countdown{font-size:72px;font-weight:700;color:#e53935;animation:pulse 0.5s}
  @keyframes pulse{0%{transform:scale(0.5);opacity:0}50%{transform:scale(1.2)}100%{transform:scale(1);opacity:1}}
</style>
</head>
<body>
<div class="container">
  <h1>üîç –©–æ –∑–Ω–∏–∫–ª–æ?</h1>
  <p class="subtitle">–¢—Ä–µ–Ω—É–π —Å–≤–æ—é –ø–∞–º'—è—Ç—å!</p>

  <div id="menu" class="menu">
    <p style="font-size:16px;color:#555;margin-bottom:15px">–ó–∞–ø–∞–º'—è—Ç–∞–π –ø—Ä–µ–¥–º–µ—Ç–∏, –ø–æ—Ç—ñ–º –≤–≥–∞–¥–∞–π ‚Äî —è–∫–∏–π –∑–Ω–∏–∫!</p>
    <button class="menu-btn btn-easy" onclick="startGame(4,5)">üå± –õ–µ–≥–∫–æ (4 –ø—Ä–µ–¥–º–µ—Ç–∏, 5 —Ä–∞—É–Ω–¥—ñ–≤)</button>
    <button class="menu-btn btn-medium" onclick="startGame(6,7)">üåü –°–µ—Ä–µ–¥–Ω—å–æ (6 –ø—Ä–µ–¥–º–µ—Ç—ñ–≤, 7 —Ä–∞—É–Ω–¥—ñ–≤)</button>
    <button class="menu-btn btn-hard" onclick="startGame(8,10)">üî• –°–∫–ª–∞–¥–Ω–æ (8 –ø—Ä–µ–¥–º–µ—Ç—ñ–≤, 10 —Ä–∞—É–Ω–¥—ñ–≤)</button>
  </div>

  <div id="game" class="game">
    <button class="back-btn" onclick="backToMenu()">‚Üê –ú–µ–Ω—é</button>
    <div class="round-info" id="roundInfo"></div>
    <div class="phase-text" id="phaseText"></div>
    <div class="timer-bar" id="timerBar"><div class="timer-fill" id="timerFill" style="width:100%"></div></div>
    <div class="grid" id="grid"></div>
    <div class="answers" id="answers"></div>
    <div id="hintArea" style="display:none">
      <button class="hint-btn" id="hintBtn" onclick="useHint()">üí° –ü—ñ–¥–∫–∞–∑–∫–∞</button>
    </div>
  </div>

  <div id="result" style="display:none">
    <div class="score-section">
      <div class="score-emoji" id="resEmoji"></div>
      <div class="score-big" id="resScore"></div>
      <div class="score-msg" id="resMsg"></div>
      <button class="retry-btn" onclick="backToMenu()">üîÑ –ì—Ä–∞—Ç–∏ —â–µ</button>
    </div>
  </div>
</div>

<script>
const ALL_EMOJIS = ['üçé','üçå','üçá','üçí','üçì','üçë','ü•ù','üçã','üçä','üçâ','ü•≠','ü´ê',
  'üê∂','üê±','üê∞','üê∏','ü¶ä','üêª','üêº','ü¶Å','üê®','üêØ','ü¶ã','üêù',
  '‚öΩ','üèÄ','üéæ','üé∏','üé∫','üé®','üìö','‚úèÔ∏è','üîî','‚≠ê','‚ù§Ô∏è','üåà',
  'üöó','üöÄ','‚úàÔ∏è','üö≤','üè†','üåª','üå∏','üçï','üéÇ','üßÅ','üç©','üéÅ',
  'üëë','üíé','üé©','üß∏','üéØ','ü™Å','‚õµ','ü¶Ñ'];

let itemCount, totalRounds, currentRound, score, currentItems, removedItem;
let timerInterval, hintUsed;

function shuffle(arr){
  const a=[...arr];
  for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]]}
  return a;
}

function pickRandom(arr,n){return shuffle(arr).slice(0,n)}

function startGame(items,rounds){
  itemCount=items;totalRounds=rounds;currentRound=0;score=0;
  document.getElementById('menu').style.display='none';
  document.getElementById('result').style.display='none';
  document.getElementById('game').style.display='block';
  nextRound();
}

function nextRound(){
  currentRound++;
  if(currentRound>totalRounds){showResult();return}
  document.getElementById('roundInfo').textContent='–†–∞—É–Ω–¥ '+currentRound+' –∑ '+totalRounds+' | –†–∞—Ö—É–Ω–æ–∫: '+score;
  document.getElementById('answers').innerHTML='';
  
  // Pick items
  currentItems=pickRandom(ALL_EMOJIS,itemCount);
  
  // Show phase
  showItems('üëÄ –ó–∞–ø–∞–º\'—è—Ç–∞–π!');
  
  // Timer for memorizing
  const memTime=itemCount<=4?8000:itemCount<=6?12000:15000;
  startTimer(memTime);
  
  setTimeout(()=>{
    stopTimer();
    hideAndAsk();
  },memTime);
}

function showItems(text){
  document.getElementById('phaseText').textContent=text;
  const grid=document.getElementById('grid');
  grid.innerHTML='';
  currentItems.forEach(emoji=>{
    const div=document.createElement('div');
    div.className='item';
    div.textContent=emoji;
    grid.appendChild(div);
  });
}

function hideAndAsk(){
  // Remove one random item
  const removeIdx=Math.floor(Math.random()*currentItems.length);
  removedItem=currentItems[removeIdx];
  
  // Show remaining items
  const remaining=[...currentItems];
  remaining.splice(removeIdx,1);
  
  document.getElementById('phaseText').textContent='‚ùì –©–æ –∑–Ω–∏–∫–ª–æ?';
  const grid=document.getElementById('grid');
  grid.innerHTML='';
  remaining.forEach(emoji=>{
    const div=document.createElement('div');
    div.className='item';
    div.textContent=emoji;
    grid.appendChild(div);
  });
  
  // Show answer options (correct + 2-3 wrong)
  const wrongCount=itemCount<=4?2:3;
  const wrongOptions=pickRandom(ALL_EMOJIS.filter(e=>!currentItems.includes(e)),wrongCount);
  const options=shuffle([removedItem,...wrongOptions]);
  
  const answers=document.getElementById('answers');
  answers.innerHTML='';
  options.forEach(emoji=>{
    const btn=document.createElement('div');
    btn.className='answer-btn';
    btn.textContent=emoji;
    btn.onclick=()=>checkAnswer(emoji,btn);
    answers.appendChild(btn);
  });

  // Show hint button
  hintUsed=false;
  document.getElementById('hintArea').style.display='block';
  document.getElementById('hintBtn').disabled=false;
  document.getElementById('hintBtn').textContent='üí° –ü—ñ–¥–∫–∞–∑–∫–∞';

  // Timer for answering
  const ansTime=itemCount<=4?15000:itemCount<=6?25000:30000;
  startTimer(ansTime);
  setTimeout(()=>{
    stopTimer();
    // Time's up ‚Äî no answer shown, just move on
    if(document.getElementById('answers').innerHTML){
      document.getElementById('phaseText').textContent='‚è∞ –ß–∞—Å –≤–∏–π—à–æ–≤!';
      document.getElementById('hintArea').style.display='none';
      document.querySelectorAll('.answer-btn').forEach(b=>b.onclick=null);
      setTimeout(nextRound,1500);
    }
  },ansTime);
}

function checkAnswer(emoji,btn){
  stopTimer();
  // Disable all buttons
  document.querySelectorAll('.answer-btn').forEach(b=>b.onclick=null);
  
  document.getElementById('hintArea').style.display='none';
  if(emoji===removedItem){
    btn.style.background='#e8f5e9';
    btn.style.borderColor='#4CAF50';
    document.getElementById('phaseText').textContent='‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ!';
    score++;
  }else{
    btn.style.background='#ffebee';
    btn.style.borderColor='#f44336';
    document.getElementById('phaseText').textContent='‚ùå –ù–µ –≤–≥–∞–¥–∞–≤!';
    document.querySelectorAll('.answer-btn').forEach(b=>b.onclick=null);
    setTimeout(nextRound,1500);
    return;
  }
  
  document.getElementById('roundInfo').textContent='–†–∞—É–Ω–¥ '+currentRound+' –∑ '+totalRounds+' | –†–∞—Ö—É–Ω–æ–∫: '+score;
  setTimeout(nextRound,1200);
}

function useHint(){
  if(hintUsed) return;
  hintUsed=true;
  const btn=document.getElementById('hintBtn');
  btn.disabled=true;
  btn.textContent='üí° –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ';

  // Remove one wrong answer button
  const btns=[...document.querySelectorAll('.answer-btn')].filter(b=>b.onclick!==null && b.textContent!==removedItem);
  if(btns.length>0){
    const remove=btns[Math.floor(Math.random()*btns.length)];
    remove.style.opacity='0.2';
    remove.style.pointerEvents='none';
    remove.onclick=null;
  }
}

function showResult(){
  document.getElementById('game').style.display='none';
  document.getElementById('result').style.display='block';
  
  const pct=score/totalRounds*100;
  let emoji,msg;
  if(pct>=90){emoji='üèÜüéâüåü';msg='–ù–µ–π–º–æ–≤—ñ—Ä–Ω–∞ –ø–∞–º\'—è—Ç—å!';confetti()}
  else if(pct>=70){emoji='üëèüòä';msg='–ß—É–¥–æ–≤–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç!';confetti()}
  else if(pct>=50){emoji='ü§îüí™';msg='–ù–µ–ø–æ–≥–∞–Ω–æ! –¢—Ä–µ–Ω—É–π—Å—è —â–µ!'}
  else{emoji='üòÖüìö';msg='–°–ø—Ä–æ–±—É–π —â–µ —Ä–∞–∑!'}
  
  document.getElementById('resEmoji').textContent=emoji;
  document.getElementById('resScore').textContent=score+'/'+totalRounds;
  document.getElementById('resMsg').textContent=msg;
}

function backToMenu(){
  stopTimer();
  document.getElementById('game').style.display='none';
  document.getElementById('result').style.display='none';
  document.getElementById('hintArea').style.display='none';
  document.getElementById('menu').style.display='block';
}

function startTimer(ms){
  const fill=document.getElementById('timerFill');
  fill.style.width='100%';
  fill.style.background='linear-gradient(90deg,#4CAF50,#FFD700)';
  const start=Date.now();
  timerInterval=setInterval(()=>{
    const elapsed=Date.now()-start;
    const pct=Math.max(0,100-elapsed/ms*100);
    fill.style.width=pct+'%';
    if(pct<=30) fill.style.background='linear-gradient(90deg,#f44336,#FF9800)';
    else fill.style.background='linear-gradient(90deg,#4CAF50,#FFD700)';
    if(elapsed>=ms) clearInterval(timerInterval);
  },50);
}

function stopTimer(){
  clearInterval(timerInterval);
}

function confetti(){
  const colors=['#FFD700','#FF6B6B','#4CAF50','#2196F3','#FF9800','#9C27B0'];
  for(let i=0;i<35;i++){setTimeout(()=>{const p=document.createElement('div');p.className='confetti-piece';p.style.left=Math.random()*100+'vw';p.style.background=colors[Math.floor(Math.random()*colors.length)];p.style.animationDuration=(2+Math.random()*2)+'s';p.style.width=(6+Math.random()*8)+'px';p.style.height=(6+Math.random()*8)+'px';document.body.appendChild(p);setTimeout(()=>p.remove(),4000)},i*50)}
}
</script>
</body>
</html>
